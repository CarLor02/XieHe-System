# åŒ»ç–—å½±åƒè¯Šæ–­ç³»ç»Ÿ - å®‰å…¨æ¶æ„è®¾è®¡

## ğŸ“‹ æ–‡æ¡£æ¦‚è¿°

æœ¬æ–‡æ¡£è¯¦ç»†æè¿°äº†åŒ»ç–—å½±åƒè¯Šæ–­ç³»ç»Ÿçš„å®‰å…¨æ¶æ„è®¾è®¡ï¼ŒåŒ…æ‹¬è®¤è¯æˆæƒã€æ•°æ®åŠ å¯†ã€ç½‘ç»œå®‰å…¨ã€åº”ç”¨å®‰å…¨ã€åŸºç¡€è®¾æ–½å®‰å…¨ç­‰å…¨æ–¹ä½çš„å®‰å…¨é˜²æŠ¤ä½“ç³»ã€‚

**æ–‡æ¡£ç‰ˆæœ¬**: 1.0.0  
**åˆ›å»ºæ—¥æœŸ**: 2025-09-24  
**æ›´æ–°æ—¥æœŸ**: 2025-09-24  
**ä½œè€…**: åŒ»ç–—å½±åƒå›¢é˜Ÿ  
**å®‰å…¨ç­‰çº§**: æœºå¯†

## ğŸ¯ å®‰å…¨è®¾è®¡åŸåˆ™

### æ ¸å¿ƒå®‰å…¨åŸåˆ™
1. **çºµæ·±é˜²å¾¡**: å¤šå±‚å®‰å…¨é˜²æŠ¤ï¼Œå•ç‚¹å¤±æ•ˆä¸å½±å“æ•´ä½“å®‰å…¨
2. **æœ€å°æƒé™**: ç”¨æˆ·å’Œç³»ç»Ÿç»„ä»¶ä»…è·å¾—å¿…éœ€çš„æœ€å°æƒé™
3. **é›¶ä¿¡ä»»**: ä¸ä¿¡ä»»ä»»ä½•ç”¨æˆ·æˆ–è®¾å¤‡ï¼Œæ‰€æœ‰è®¿é—®éƒ½éœ€éªŒè¯
4. **æ•°æ®ä¿æŠ¤**: æ•æ„Ÿæ•°æ®å…¨ç”Ÿå‘½å‘¨æœŸåŠ å¯†ä¿æŠ¤
5. **åˆè§„æ€§**: ç¬¦åˆåŒ»ç–—è¡Œä¸šå®‰å…¨æ ‡å‡†å’Œæ³•è§„è¦æ±‚

### å®‰å…¨åˆè§„æ ‡å‡†
- **HIPAA**: ç¾å›½å¥åº·ä¿é™©æµé€šä¸è´£ä»»æ³•æ¡ˆ
- **GDPR**: æ¬§ç›Ÿé€šç”¨æ•°æ®ä¿æŠ¤æ¡ä¾‹
- **ISO 27001**: ä¿¡æ¯å®‰å…¨ç®¡ç†ä½“ç³»å›½é™…æ ‡å‡†
- **ç­‰ä¿2.0**: ä¸­å›½ç½‘ç»œå®‰å…¨ç­‰çº§ä¿æŠ¤2.0
- **åŒ»ç–—æ•°æ®å®‰å…¨æ ‡å‡†**: å›½å®¶å«å¥å§”åŒ»ç–—æ•°æ®å®‰å…¨è§„èŒƒ

## ğŸ—ï¸ å®‰å…¨æ¶æ„æ€»è§ˆ

### äº”å±‚å®‰å…¨æ¶æ„
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    ç”¨æˆ·æ¥å…¥å±‚                            â”‚
â”‚  Webæµè§ˆå™¨ | ç§»åŠ¨åº”ç”¨ | ç¬¬ä¸‰æ–¹ç³»ç»Ÿ | ç®¡ç†ç»ˆç«¯              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                            â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    ç½‘ç»œå®‰å…¨å±‚                            â”‚
â”‚  WAF | DDoSé˜²æŠ¤ | SSL/TLS | VPN | é˜²ç«å¢™ | IDS/IPS      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                            â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                   åº”ç”¨å®‰å…¨å±‚                             â”‚
â”‚  èº«ä»½è®¤è¯ | æƒé™æ§åˆ¶ | ä¼šè¯ç®¡ç† | è¾“å…¥éªŒè¯ | è¾“å‡ºç¼–ç       â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                            â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                   æ•°æ®å®‰å…¨å±‚                             â”‚
â”‚  æ•°æ®åŠ å¯† | æ•°æ®è„±æ• | å¤‡ä»½åŠ å¯† | ä¼ è¾“åŠ å¯† | å¯†é’¥ç®¡ç†      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                            â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                 åŸºç¡€è®¾æ–½å®‰å…¨å±‚                           â”‚
â”‚  ä¸»æœºåŠ å›º | å®¹å™¨å®‰å…¨ | ç½‘ç»œéš”ç¦» | ç›‘æ§å®¡è®¡ | åº”æ€¥å“åº”      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## ğŸ” èº«ä»½è®¤è¯ä¸æˆæƒ

### 1. å¤šå› ç´ è®¤è¯(MFA)

#### è®¤è¯å› å­
```yaml
è®¤è¯å› å­ç±»å‹:
  çŸ¥è¯†å› å­:
    - ç”¨æˆ·åå¯†ç 
    - å®‰å…¨é—®é¢˜
    - PINç 
  
  æŒæœ‰å› å­:
    - çŸ­ä¿¡éªŒè¯ç 
    - é‚®ä»¶éªŒè¯ç 
    - ç¡¬ä»¶ä»¤ç‰Œ
    - ç§»åŠ¨åº”ç”¨ä»¤ç‰Œ
  
  ç”Ÿç‰©å› å­:
    - æŒ‡çº¹è¯†åˆ«
    - é¢éƒ¨è¯†åˆ«
    - å£°çº¹è¯†åˆ«
```

#### è®¤è¯æµç¨‹
```mermaid
sequenceDiagram
    participant U as ç”¨æˆ·
    participant C as å®¢æˆ·ç«¯
    participant A as è®¤è¯æœåŠ¡
    participant M as MFAæœåŠ¡
    participant D as æ•°æ®åº“

    U->>C: è¾“å…¥ç”¨æˆ·åå¯†ç 
    C->>A: æäº¤è®¤è¯è¯·æ±‚
    A->>D: éªŒè¯ç”¨æˆ·å‡­æ®
    D-->>A: è¿”å›ç”¨æˆ·ä¿¡æ¯
    A->>M: è§¦å‘MFAéªŒè¯
    M->>U: å‘é€éªŒè¯ç 
    U->>C: è¾“å…¥éªŒè¯ç 
    C->>M: æäº¤éªŒè¯ç 
    M-->>A: éªŒè¯ç»“æœ
    A-->>C: è¿”å›JWTä»¤ç‰Œ
    C-->>U: ç™»å½•æˆåŠŸ
```

### 2. JWTä»¤ç‰Œç®¡ç†

#### ä»¤ç‰Œç»“æ„
```json
{
  "header": {
    "alg": "RS256",
    "typ": "JWT",
    "kid": "key-id-2025"
  },
  "payload": {
    "sub": "user_123",
    "iss": "medical-system",
    "aud": "medical-api",
    "exp": 1640995200,
    "iat": 1640991600,
    "jti": "token_unique_id",
    "roles": ["doctor", "radiologist"],
    "permissions": ["patient:read", "study:read", "report:write"],
    "department": "radiology",
    "session_id": "session_456"
  }
}
```

#### ä»¤ç‰Œå®‰å…¨ç­–ç•¥
```yaml
è®¿é—®ä»¤ç‰Œ(Access Token):
  æœ‰æ•ˆæœŸ: 1å°æ—¶
  ç”¨é€”: APIè®¿é—®è®¤è¯
  å­˜å‚¨: å†…å­˜ä¸­ï¼Œä¸æŒä¹…åŒ–
  
åˆ·æ–°ä»¤ç‰Œ(Refresh Token):
  æœ‰æ•ˆæœŸ: 7å¤©
  ç”¨é€”: è·å–æ–°çš„è®¿é—®ä»¤ç‰Œ
  å­˜å‚¨: HttpOnly Cookie + æ•°æ®åº“
  
ä»¤ç‰Œè½®æ¢:
  ç­–ç•¥: æ¯æ¬¡åˆ·æ–°ç”Ÿæˆæ–°çš„åˆ·æ–°ä»¤ç‰Œ
  é»‘åå•: ç»´æŠ¤å·²æ’¤é”€ä»¤ç‰Œé»‘åå•
  
å®‰å…¨æªæ–½:
  - ä»¤ç‰Œç»‘å®šIPåœ°å€
  - ä»¤ç‰Œç»‘å®šè®¾å¤‡æŒ‡çº¹
  - å¼‚å¸¸ç™»å½•æ£€æµ‹
  - å¹¶å‘ä¼šè¯é™åˆ¶
```

### 3. åŸºäºè§’è‰²çš„è®¿é—®æ§åˆ¶(RBAC)

#### æƒé™æ¨¡å‹
```yaml
æƒé™å±‚æ¬¡ç»“æ„:
  ç³»ç»Ÿç®¡ç†å‘˜:
    - ç³»ç»Ÿé…ç½®ç®¡ç†
    - ç”¨æˆ·è´¦æˆ·ç®¡ç†
    - å®‰å…¨ç­–ç•¥é…ç½®
    - ç³»ç»Ÿç›‘æ§æŸ¥çœ‹
  
  ç§‘å®¤ä¸»ä»»:
    - ç§‘å®¤ç”¨æˆ·ç®¡ç†
    - ç§‘å®¤æ•°æ®æŸ¥çœ‹
    - æŠ¥å‘Šå®¡æ ¸æ‰¹å‡†
    - å·¥ä½œæµç¨‹é…ç½®
  
  ä¸»æ²»åŒ»å¸ˆ:
    - æ‚£è€…ä¿¡æ¯ç®¡ç†
    - å½±åƒæ•°æ®æŸ¥çœ‹
    - è¯Šæ–­æŠ¥å‘Šç¼–å†™
    - AIè¾…åŠ©è¯Šæ–­
  
  ä½é™¢åŒ»å¸ˆ:
    - æ‚£è€…ä¿¡æ¯æŸ¥çœ‹
    - å½±åƒæ•°æ®æŸ¥çœ‹
    - æŠ¥å‘Šè‰ç¨¿ç¼–å†™
  
  æŠ€å¸ˆ:
    - å½±åƒæ•°æ®ä¸Šä¼ 
    - è®¾å¤‡çŠ¶æ€ç®¡ç†
    - æ£€æŸ¥é¢„çº¦ç®¡ç†
  
  æŠ¤å£«:
    - æ‚£è€…åŸºæœ¬ä¿¡æ¯æŸ¥çœ‹
    - æ£€æŸ¥é¢„çº¦æŸ¥çœ‹
```

#### æƒé™æ§åˆ¶å®ç°
```python
# æƒé™è£…é¥°å™¨ç¤ºä¾‹
@require_permissions("patient:read", "study:read")
@require_roles("doctor", "technician")
def get_patient_studies(patient_id: str, current_user: User):
    # æ•°æ®çº§æƒé™æ§åˆ¶
    if not can_access_patient(current_user, patient_id):
        raise PermissionDenied("æ— æƒè®¿é—®è¯¥æ‚£è€…æ•°æ®")
    
    # éƒ¨é—¨çº§æƒé™æ§åˆ¶
    if current_user.department != get_patient_department(patient_id):
        if not has_cross_department_permission(current_user):
            raise PermissionDenied("æ— æƒè·¨éƒ¨é—¨è®¿é—®æ•°æ®")
    
    return get_studies_by_patient(patient_id)
```

## ğŸ”’ æ•°æ®å®‰å…¨ä¿æŠ¤

### 1. æ•°æ®åˆ†ç±»åˆ†çº§

#### æ•°æ®åˆ†ç±»æ ‡å‡†
```yaml
æ•°æ®åˆ†ç±»:
  å…¬å¼€æ•°æ®:
    - ç³»ç»Ÿå…¬å‘Š
    - å¸®åŠ©æ–‡æ¡£
    - å…¬å¼€é…ç½®
    ä¿æŠ¤çº§åˆ«: æ— éœ€åŠ å¯†
  
  å†…éƒ¨æ•°æ®:
    - ç”¨æˆ·åŸºæœ¬ä¿¡æ¯
    - ç³»ç»Ÿæ—¥å¿—
    - ç»Ÿè®¡æ•°æ®
    ä¿æŠ¤çº§åˆ«: ä¼ è¾“åŠ å¯†
  
  æ•æ„Ÿæ•°æ®:
    - æ‚£è€…ä¸ªäººä¿¡æ¯
    - åŒ»ç–—è®°å½•
    - è¯Šæ–­ç»“æœ
    ä¿æŠ¤çº§åˆ«: å­˜å‚¨+ä¼ è¾“åŠ å¯†
  
  æœºå¯†æ•°æ®:
    - èº«ä»½è¯å·
    - ç—…å†è¯¦æƒ…
    - åŸºå› ä¿¡æ¯
    ä¿æŠ¤çº§åˆ«: å¼ºåŠ å¯†+è®¿é—®æ§åˆ¶
```

### 2. åŠ å¯†ç­–ç•¥

#### å­˜å‚¨åŠ å¯†
```yaml
æ•°æ®åº“åŠ å¯†:
  æ•æ„Ÿå­—æ®µåŠ å¯†:
    ç®—æ³•: AES-256-GCM
    å¯†é’¥ç®¡ç†: HSMç¡¬ä»¶å®‰å…¨æ¨¡å—
    å­—æ®µ: èº«ä»½è¯å·ã€æ‰‹æœºå·ã€åœ°å€
  
  é€æ˜æ•°æ®åŠ å¯†(TDE):
    èŒƒå›´: æ•´ä¸ªæ•°æ®åº“æ–‡ä»¶
    ç®—æ³•: AES-256
    å¯†é’¥è½®æ¢: æ¯å­£åº¦è‡ªåŠ¨è½®æ¢
  
æ–‡ä»¶å­˜å‚¨åŠ å¯†:
  DICOMæ–‡ä»¶:
    ç®—æ³•: AES-256-CBC
    å¯†é’¥: æ¯ä¸ªæ–‡ä»¶ç‹¬ç«‹å¯†é’¥
    å®Œæ•´æ€§: HMAC-SHA256æ ¡éªŒ
  
  å¤‡ä»½åŠ å¯†:
    ç®—æ³•: AES-256-GCM
    å‹ç¼©: å…ˆå‹ç¼©ååŠ å¯†
    éªŒè¯: æ•°å­—ç­¾åéªŒè¯
```

#### ä¼ è¾“åŠ å¯†
```yaml
HTTPS/TLSé…ç½®:
  åè®®ç‰ˆæœ¬: TLS 1.3
  åŠ å¯†å¥—ä»¶: 
    - TLS_AES_256_GCM_SHA384
    - TLS_CHACHA20_POLY1305_SHA256
  è¯ä¹¦: ECC P-384 + RSA 4096
  HSTS: å¼ºåˆ¶HTTPSï¼Œmax-age=31536000
  
APIé€šä¿¡:
  è¯·æ±‚ç­¾å: HMAC-SHA256
  æ—¶é—´æˆ³éªŒè¯: é˜²é‡æ”¾æ”»å‡»
  è¯·æ±‚åŠ å¯†: æ•æ„Ÿå‚æ•°AESåŠ å¯†
  
å†…éƒ¨æœåŠ¡:
  mTLS: åŒå‘TLSè®¤è¯
  è¯ä¹¦ç®¡ç†: è‡ªåŠ¨è½®æ¢
  ç½‘ç»œéš”ç¦»: æœåŠ¡ç½‘æ ¼
```

### 3. æ•°æ®è„±æ•

#### è„±æ•ç­–ç•¥
```python
# æ•°æ®è„±æ•è§„åˆ™
MASKING_RULES = {
    'phone': lambda x: x[:3] + '****' + x[-4:],  # 138****1234
    'id_card': lambda x: x[:6] + '********' + x[-4:],  # 110101********1234
    'email': lambda x: x.split('@')[0][:2] + '***@' + x.split('@')[1],
    'name': lambda x: x[0] + '*' * (len(x) - 1),  # å¼ ***
    'address': lambda x: x[:6] + '***' if len(x) > 6 else '***'
}

# åŠ¨æ€è„±æ•
def apply_data_masking(data: dict, user_role: str) -> dict:
    if user_role in ['admin', 'doctor']:
        return data  # å®Œæ•´æ•°æ®
    elif user_role == 'nurse':
        return mask_sensitive_fields(data, ['id_card', 'address'])
    else:
        return mask_sensitive_fields(data, ['phone', 'id_card', 'address'])
```

## ğŸŒ ç½‘ç»œå®‰å…¨é˜²æŠ¤

### 1. ç½‘ç»œæ¶æ„å®‰å…¨

#### ç½‘ç»œåˆ†åŒº
```yaml
ç½‘ç»œåˆ†åŒºè®¾è®¡:
  DMZåŒº:
    - Webåº”ç”¨æœåŠ¡å™¨
    - è´Ÿè½½å‡è¡¡å™¨
    - WAFè®¾å¤‡
    è®¿é—®æ§åˆ¶: ä»…å…è®¸HTTP/HTTPS
  
  åº”ç”¨åŒº:
    - APIæœåŠ¡å™¨
    - åº”ç”¨æœåŠ¡å™¨
    - ç¼“å­˜æœåŠ¡å™¨
    è®¿é—®æ§åˆ¶: ä»…å…è®¸åº”ç”¨ç«¯å£
  
  æ•°æ®åŒº:
    - æ•°æ®åº“æœåŠ¡å™¨
    - æ–‡ä»¶å­˜å‚¨æœåŠ¡å™¨
    - å¤‡ä»½æœåŠ¡å™¨
    è®¿é—®æ§åˆ¶: ä»…å…è®¸æ•°æ®åº“ç«¯å£
  
  ç®¡ç†åŒº:
    - ç›‘æ§æœåŠ¡å™¨
    - æ—¥å¿—æœåŠ¡å™¨
    - è·³æ¿æœº
    è®¿é—®æ§åˆ¶: ç®¡ç†å‘˜ä¸“ç”¨ç½‘ç»œ
```

### 2. Webåº”ç”¨é˜²ç«å¢™(WAF)

#### é˜²æŠ¤è§„åˆ™
```yaml
WAFé˜²æŠ¤ç­–ç•¥:
  OWASP Top 10é˜²æŠ¤:
    - SQLæ³¨å…¥é˜²æŠ¤
    - XSSæ”»å‡»é˜²æŠ¤
    - CSRFæ”»å‡»é˜²æŠ¤
    - æ–‡ä»¶ä¸Šä¼ æ¼æ´é˜²æŠ¤
    - å‘½ä»¤æ³¨å…¥é˜²æŠ¤
  
  è‡ªå®šä¹‰è§„åˆ™:
    - åŒ»ç–—æ•°æ®è®¿é—®æ¨¡å¼æ£€æµ‹
    - å¼‚å¸¸APIè°ƒç”¨æ£€æµ‹
    - å¤§é‡æ•°æ®ä¸‹è½½æ£€æµ‹
    - æ•æ„Ÿæ“ä½œé¢‘ç‡é™åˆ¶
  
  IPç™½åå•:
    - åŒ»é™¢å†…ç½‘IPæ®µ
    - åˆä½œæœºæ„IP
    - ç®¡ç†å‘˜IP
  
  åœ°ç†ä½ç½®é™åˆ¶:
    - ä»…å…è®¸å›½å†…è®¿é—®
    - ç‰¹å®šåŸå¸‚é™åˆ¶
```

### 3. DDoSé˜²æŠ¤

#### é˜²æŠ¤ç­–ç•¥
```yaml
DDoSé˜²æŠ¤:
  ç½‘ç»œå±‚é˜²æŠ¤:
    - SYN Floodé˜²æŠ¤
    - UDP Floodé˜²æŠ¤
    - ICMP Floodé˜²æŠ¤
    æ¸…æ´—èƒ½åŠ›: 100Gbps
  
  åº”ç”¨å±‚é˜²æŠ¤:
    - HTTP Floodé˜²æŠ¤
    - CCæ”»å‡»é˜²æŠ¤
    - æ…¢é€Ÿæ”»å‡»é˜²æŠ¤
    æ£€æµ‹é˜ˆå€¼: 1000 req/s/IP
  
  æ™ºèƒ½é˜²æŠ¤:
    - æœºå™¨å­¦ä¹ å¼‚å¸¸æ£€æµ‹
    - è¡Œä¸ºåˆ†æ
    - è‡ªé€‚åº”é˜ˆå€¼è°ƒæ•´
```

## ğŸ›¡ï¸ åº”ç”¨å®‰å…¨é˜²æŠ¤

### 1. è¾“å…¥éªŒè¯ä¸è¾“å‡ºç¼–ç 

#### è¾“å…¥éªŒè¯
```python
# è¾“å…¥éªŒè¯æ¡†æ¶
from pydantic import BaseModel, validator
from typing import Optional
import re

class PatientCreateRequest(BaseModel):
    name: str
    phone: Optional[str]
    id_card: Optional[str]
    
    @validator('name')
    def validate_name(cls, v):
        if not re.match(r'^[\u4e00-\u9fa5a-zA-Z\s]{2,50}$', v):
            raise ValueError('å§“åæ ¼å¼ä¸æ­£ç¡®')
        return v
    
    @validator('phone')
    def validate_phone(cls, v):
        if v and not re.match(r'^1[3-9]\d{9}$', v):
            raise ValueError('æ‰‹æœºå·æ ¼å¼ä¸æ­£ç¡®')
        return v
    
    @validator('id_card')
    def validate_id_card(cls, v):
        if v and not re.match(r'^\d{17}[\dXx]$', v):
            raise ValueError('èº«ä»½è¯å·æ ¼å¼ä¸æ­£ç¡®')
        return v

# SQLæ³¨å…¥é˜²æŠ¤
def safe_query(query: str, params: dict):
    # ä½¿ç”¨å‚æ•°åŒ–æŸ¥è¯¢
    return db.execute(text(query), params)

# XSSé˜²æŠ¤
def sanitize_html(content: str) -> str:
    import bleach
    allowed_tags = ['p', 'br', 'strong', 'em']
    return bleach.clean(content, tags=allowed_tags, strip=True)
```

### 2. ä¼šè¯å®‰å…¨ç®¡ç†

#### ä¼šè¯é…ç½®
```python
# ä¼šè¯å®‰å…¨é…ç½®
SESSION_CONFIG = {
    'cookie_secure': True,  # ä»…HTTPSä¼ è¾“
    'cookie_httponly': True,  # é˜²æ­¢XSSè®¿é—®
    'cookie_samesite': 'Strict',  # é˜²CSRF
    'session_timeout': 3600,  # 1å°æ—¶è¶…æ—¶
    'max_concurrent_sessions': 3,  # æœ€å¤§å¹¶å‘ä¼šè¯
    'session_regeneration': True,  # ç™»å½•åé‡æ–°ç”Ÿæˆä¼šè¯ID
}

# ä¼šè¯å›ºå®šæ”»å‡»é˜²æŠ¤
def regenerate_session_id(user_id: str):
    old_session_id = get_current_session_id()
    new_session_id = generate_new_session_id()
    
    # è¿ç§»ä¼šè¯æ•°æ®
    migrate_session_data(old_session_id, new_session_id)
    
    # é”€æ¯æ—§ä¼šè¯
    destroy_session(old_session_id)
    
    return new_session_id
```

### 3. æ–‡ä»¶ä¸Šä¼ å®‰å…¨

#### ä¸Šä¼ å®‰å…¨ç­–ç•¥
```python
# æ–‡ä»¶ä¸Šä¼ å®‰å…¨æ£€æŸ¥
class SecureFileUpload:
    ALLOWED_EXTENSIONS = {'.dcm', '.jpg', '.png', '.pdf'}
    MAX_FILE_SIZE = 100 * 1024 * 1024  # 100MB
    SCAN_TIMEOUT = 30  # ç—…æ¯’æ‰«æè¶…æ—¶
    
    def validate_file(self, file):
        # æ–‡ä»¶æ‰©å±•åæ£€æŸ¥
        if not self.is_allowed_extension(file.filename):
            raise ValidationError("ä¸æ”¯æŒçš„æ–‡ä»¶ç±»å‹")
        
        # æ–‡ä»¶å¤§å°æ£€æŸ¥
        if file.size > self.MAX_FILE_SIZE:
            raise ValidationError("æ–‡ä»¶å¤§å°è¶…å‡ºé™åˆ¶")
        
        # æ–‡ä»¶å¤´æ£€æŸ¥
        if not self.validate_file_header(file):
            raise ValidationError("æ–‡ä»¶æ ¼å¼éªŒè¯å¤±è´¥")
        
        # ç—…æ¯’æ‰«æ
        if not self.virus_scan(file):
            raise SecurityError("æ–‡ä»¶åŒ…å«æ¶æ„ä»£ç ")
        
        return True
    
    def secure_filename(self, filename: str) -> str:
        # ç”Ÿæˆå®‰å…¨çš„æ–‡ä»¶å
        import uuid
        ext = os.path.splitext(filename)[1]
        return f"{uuid.uuid4().hex}{ext}"
```

## ğŸ” å®‰å…¨ç›‘æ§ä¸å®¡è®¡

### 1. å®‰å…¨äº‹ä»¶ç›‘æ§

#### ç›‘æ§æŒ‡æ ‡
```yaml
å®‰å…¨ç›‘æ§æŒ‡æ ‡:
  è®¤è¯äº‹ä»¶:
    - ç™»å½•å¤±è´¥æ¬¡æ•°
    - å¼‚åœ°ç™»å½•æ£€æµ‹
    - æš´åŠ›ç ´è§£æ£€æµ‹
    - æƒé™æå‡å°è¯•
  
  æ•°æ®è®¿é—®:
    - æ•æ„Ÿæ•°æ®è®¿é—®
    - å¤§é‡æ•°æ®ä¸‹è½½
    - å¼‚å¸¸æ—¶é—´è®¿é—®
    - è·¨éƒ¨é—¨æ•°æ®è®¿é—®
  
  ç³»ç»Ÿå¼‚å¸¸:
    - å¼‚å¸¸APIè°ƒç”¨
    - ç³»ç»Ÿé”™è¯¯æ¿€å¢
    - æ€§èƒ½å¼‚å¸¸
    - é…ç½®å˜æ›´
  
  ç½‘ç»œå®‰å…¨:
    - æ¶æ„IPè®¿é—®
    - DDoSæ”»å‡»
    - ç«¯å£æ‰«æ
    - å¼‚å¸¸æµé‡
```

#### å‘Šè­¦è§„åˆ™
```python
# å®‰å…¨å‘Šè­¦è§„åˆ™
SECURITY_ALERT_RULES = {
    'login_failure': {
        'threshold': 5,  # 5æ¬¡å¤±è´¥
        'window': 300,   # 5åˆ†é’Ÿå†…
        'action': 'lock_account',
        'severity': 'medium'
    },
    'data_download': {
        'threshold': 1000,  # 1000æ¡è®°å½•
        'window': 3600,     # 1å°æ—¶å†…
        'action': 'notify_admin',
        'severity': 'high'
    },
    'privilege_escalation': {
        'threshold': 1,   # ä»»ä½•å°è¯•
        'window': 1,      # ç«‹å³
        'action': 'block_user',
        'severity': 'critical'
    }
}

# å®æ—¶ç›‘æ§
class SecurityMonitor:
    def __init__(self):
        self.redis = Redis()
        self.alert_manager = AlertManager()
    
    def track_event(self, event_type: str, user_id: str, details: dict):
        key = f"security:{event_type}:{user_id}"
        self.redis.lpush(key, json.dumps({
            'timestamp': time.time(),
            'details': details
        }))
        self.redis.expire(key, 3600)  # 1å°æ—¶è¿‡æœŸ
        
        # æ£€æŸ¥æ˜¯å¦è§¦å‘å‘Šè­¦
        self.check_alert_rules(event_type, user_id)
```

### 2. å®¡è®¡æ—¥å¿—

#### æ—¥å¿—è®°å½•ç­–ç•¥
```python
# å®¡è®¡æ—¥å¿—æ¨¡å‹
class AuditLog:
    def __init__(self):
        self.logger = structlog.get_logger()
    
    def log_security_event(self, event_type: str, user_id: str, 
                          resource_type: str, resource_id: str,
                          action: str, result: str, details: dict):
        log_entry = {
            'timestamp': datetime.utcnow().isoformat(),
            'event_type': event_type,
            'user_id': user_id,
            'username': get_username(user_id),
            'ip_address': get_client_ip(),
            'user_agent': get_user_agent(),
            'resource_type': resource_type,
            'resource_id': resource_id,
            'action': action,
            'result': result,
            'details': details,
            'session_id': get_session_id(),
            'request_id': get_request_id()
        }
        
        # è®°å½•åˆ°å¤šä¸ªç›®æ ‡
        self.logger.info("security_event", **log_entry)
        self.store_to_database(log_entry)
        self.send_to_siem(log_entry)

# å…³é”®æ“ä½œå®¡è®¡
@audit_log(action="patient_create")
def create_patient(patient_data: dict, current_user: User):
    try:
        patient = Patient.create(patient_data)
        audit.log_success("patient", patient.id, patient_data)
        return patient
    except Exception as e:
        audit.log_failure("patient", None, str(e))
        raise
```

## ğŸš¨ åº”æ€¥å“åº”ä¸æ¢å¤

### 1. å®‰å…¨äº‹ä»¶å“åº”

#### å“åº”æµç¨‹
```yaml
å®‰å…¨äº‹ä»¶å“åº”æµç¨‹:
  äº‹ä»¶åˆ†ç±»:
    P0 - ä¸¥é‡å®‰å…¨äº‹ä»¶:
      - æ•°æ®æ³„éœ²
      - ç³»ç»Ÿè¢«å…¥ä¾µ
      - å‹’ç´¢è½¯ä»¶æ”»å‡»
      å“åº”æ—¶é—´: 15åˆ†é’Ÿå†…
    
    P1 - é«˜å±å®‰å…¨äº‹ä»¶:
      - æƒé™æå‡æ”»å‡»
      - å¤§é‡å¼‚å¸¸è®¿é—®
      - ç³»ç»Ÿæ¼æ´åˆ©ç”¨
      å“åº”æ—¶é—´: 1å°æ—¶å†…
    
    P2 - ä¸­å±å®‰å…¨äº‹ä»¶:
      - æš´åŠ›ç ´è§£æ”»å‡»
      - å¼‚å¸¸ç™»å½•è¡Œä¸º
      - é…ç½®é”™è¯¯
      å“åº”æ—¶é—´: 4å°æ—¶å†…
  
  å“åº”å›¢é˜Ÿ:
    - å®‰å…¨è´Ÿè´£äºº
    - ç³»ç»Ÿç®¡ç†å‘˜
    - å¼€å‘å›¢é˜Ÿè´Ÿè´£äºº
    - æ³•åŠ¡åˆè§„äººå‘˜
  
  å“åº”æ­¥éª¤:
    1. äº‹ä»¶ç¡®è®¤ä¸åˆ†ç±»
    2. å½±å“èŒƒå›´è¯„ä¼°
    3. ç´§æ€¥å¤„ç½®æªæ–½
    4. è¯æ®ä¿å…¨
    5. ç³»ç»Ÿæ¢å¤
    6. äº‹ååˆ†æ
```

### 2. æ•°æ®å¤‡ä»½ä¸æ¢å¤

#### å¤‡ä»½ç­–ç•¥
```yaml
æ•°æ®å¤‡ä»½ç­–ç•¥:
  å¤‡ä»½ç±»å‹:
    å…¨é‡å¤‡ä»½:
      é¢‘ç‡: æ¯å‘¨ä¸€æ¬¡
      ä¿ç•™æœŸ: 3ä¸ªæœˆ
      å­˜å‚¨: å¼‚åœ°å†·å­˜å‚¨
    
    å¢é‡å¤‡ä»½:
      é¢‘ç‡: æ¯æ—¥ä¸€æ¬¡
      ä¿ç•™æœŸ: 1ä¸ªæœˆ
      å­˜å‚¨: æœ¬åœ°çƒ­å­˜å‚¨
    
    å®æ—¶å¤‡ä»½:
      é¢‘ç‡: å®æ—¶åŒæ­¥
      ä¿ç•™æœŸ: 7å¤©
      å­˜å‚¨: åŒåŸç¾å¤‡
  
  å¤‡ä»½éªŒè¯:
    - æ¯æœˆæ¢å¤æµ‹è¯•
    - æ•°æ®å®Œæ•´æ€§æ ¡éªŒ
    - æ¢å¤æ—¶é—´æµ‹è¯•
    - å¤‡ä»½æ–‡ä»¶åŠ å¯†éªŒè¯
```

## ğŸ“‹ å®‰å…¨åˆè§„æ£€æŸ¥

### 1. åˆè§„è¦æ±‚

#### HIPAAåˆè§„
```yaml
HIPAAåˆè§„è¦æ±‚:
  ç®¡ç†ä¿éšœæªæ–½:
    - æŒ‡å®šå®‰å…¨è´Ÿè´£äºº
    - åˆ¶å®šå®‰å…¨æ”¿ç­–
    - å‘˜å·¥å®‰å…¨åŸ¹è®­
    - å®šæœŸå®‰å…¨è¯„ä¼°
  
  ç‰©ç†ä¿éšœæªæ–½:
    - è®¾æ–½è®¿é—®æ§åˆ¶
    - å·¥ä½œç«™ä½¿ç”¨é™åˆ¶
    - è®¾å¤‡å’Œåª’ä½“æ§åˆ¶
  
  æŠ€æœ¯ä¿éšœæªæ–½:
    - è®¿é—®æ§åˆ¶
    - å®¡è®¡æ§åˆ¶
    - å®Œæ•´æ€§ä¿æŠ¤
    - ä¼ è¾“å®‰å…¨
```

### 2. å®‰å…¨è¯„ä¼°

#### å®šæœŸå®‰å…¨è¯„ä¼°
```python
# å®‰å…¨è¯„ä¼°æ£€æŸ¥é¡¹
SECURITY_CHECKLIST = {
    'authentication': [
        'å¯†ç ç­–ç•¥æ˜¯å¦ç¬¦åˆè¦æ±‚',
        'MFAæ˜¯å¦æ­£ç¡®é…ç½®',
        'ä¼šè¯è¶…æ—¶æ˜¯å¦åˆç†',
        'è´¦æˆ·é”å®šç­–ç•¥æ˜¯å¦æœ‰æ•ˆ'
    ],
    'authorization': [
        'æƒé™åˆ†é…æ˜¯å¦éµå¾ªæœ€å°æƒé™åŸåˆ™',
        'è§’è‰²å®šä¹‰æ˜¯å¦æ¸…æ™°',
        'æƒé™å®¡æŸ¥æ˜¯å¦å®šæœŸè¿›è¡Œ',
        'ç‰¹æƒè´¦æˆ·æ˜¯å¦å—åˆ°ç›‘æ§'
    ],
    'data_protection': [
        'æ•æ„Ÿæ•°æ®æ˜¯å¦åŠ å¯†å­˜å‚¨',
        'ä¼ è¾“è¿‡ç¨‹æ˜¯å¦åŠ å¯†',
        'æ•°æ®å¤‡ä»½æ˜¯å¦å®‰å…¨',
        'æ•°æ®é”€æ¯æ˜¯å¦å½»åº•'
    ],
    'network_security': [
        'é˜²ç«å¢™è§„åˆ™æ˜¯å¦æœ€æ–°',
        'WAFæ˜¯å¦æ­£å¸¸å·¥ä½œ',
        'ç½‘ç»œåˆ†æ®µæ˜¯å¦æœ‰æ•ˆ',
        'VPNé…ç½®æ˜¯å¦å®‰å…¨'
    ]
}

# è‡ªåŠ¨åŒ–å®‰å…¨æ‰«æ
class SecurityScanner:
    def run_vulnerability_scan(self):
        # æ¼æ´æ‰«æ
        results = []
        results.extend(self.scan_web_vulnerabilities())
        results.extend(self.scan_network_vulnerabilities())
        results.extend(self.scan_configuration_issues())
        return results
    
    def generate_security_report(self):
        # ç”Ÿæˆå®‰å…¨æŠ¥å‘Š
        report = {
            'scan_date': datetime.now(),
            'vulnerabilities': self.run_vulnerability_scan(),
            'compliance_status': self.check_compliance(),
            'recommendations': self.generate_recommendations()
        }
        return report
```

---

**ç»´æŠ¤è¯´æ˜**: æœ¬å®‰å…¨æ¶æ„è®¾è®¡æ–‡æ¡£å°†éšç€å®‰å…¨å¨èƒç¯å¢ƒå’Œåˆè§„è¦æ±‚çš„å˜åŒ–æŒç»­æ›´æ–°ï¼Œç¡®ä¿ç³»ç»Ÿå®‰å…¨é˜²æŠ¤èƒ½åŠ›å§‹ç»ˆä¿æŒåœ¨æœ€ä½³çŠ¶æ€ã€‚
