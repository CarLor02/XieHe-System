graph LR
    %% 医疗影像系统威胁模型与防护措施
    %% 威胁来源
    subgraph "威胁来源"
        T1[外部攻击者]
        T2[内部威胁]
        T3[恶意软件]
        T4[系统漏洞]
        T5[人为错误]
        T6[自然灾害]
    end

    %% 攻击向量
    subgraph "攻击向量"
        V1[网络攻击]
        V2[社会工程]
        V3[物理接触]
        V4[供应链攻击]
        V5[内部滥用]
        V6[配置错误]
    end

    %% 威胁目标
    subgraph "威胁目标"
        A1[患者数据]
        A2[医疗影像]
        A3[诊断报告]
        A4[用户凭据]
        A5[系统可用性]
        A6[数据完整性]
    end

    %% 防护措施
    subgraph "防护措施"
        subgraph "预防控制"
            P1[访问控制]
            P2[数据加密]
            P3[网络分段]
            P4[安全培训]
            P5[漏洞管理]
        end
        
        subgraph "检测控制"
            D1[入侵检测]
            D2[行为分析]
            D3[日志监控]
            D4[异常检测]
            D5[威胁情报]
        end
        
        subgraph "响应控制"
            R1[事件响应]
            R2[隔离措施]
            R3[数据恢复]
            R4[取证分析]
            R5[业务连续性]
        end
    end

    %% 威胁路径
    T1 --> V1
    T1 --> V2
    T2 --> V5
    T3 --> V1
    T4 --> V1
    T5 --> V6
    T6 --> A5

    V1 --> A1
    V1 --> A2
    V1 --> A5
    V2 --> A4
    V3 --> A1
    V4 --> A6
    V5 --> A1
    V5 --> A3
    V6 --> A5

    %% 防护关系
    P1 -.-> V5
    P1 -.-> V3
    P2 -.-> A1
    P2 -.-> A2
    P3 -.-> V1
    P4 -.-> V2
    P5 -.-> T4

    D1 -.-> V1
    D2 -.-> V5
    D3 -.-> V1
    D3 -.-> V5
    D4 -.-> T2
    D5 -.-> T1

    R1 -.-> A5
    R2 -.-> V1
    R3 -.-> A6
    R4 -.-> T1
    R5 -.-> A5

    %% 样式定义
    classDef threat fill:#ffcdd2
    classDef vector fill:#fff3e0
    classDef asset fill:#e8f5e8
    classDef prevent fill:#e3f2fd
    classDef detect fill:#f3e5f5
    classDef respond fill:#fce4ec

    class T1,T2,T3,T4,T5,T6 threat
    class V1,V2,V3,V4,V5,V6 vector
    class A1,A2,A3,A4,A5,A6 asset
    class P1,P2,P3,P4,P5 prevent
    class D1,D2,D3,D4,D5 detect
    class R1,R2,R3,R4,R5 respond
